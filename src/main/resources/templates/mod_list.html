<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="fragments/head :: headFragment">


</head>


<link th:href="@{/css/side.css}" rel="stylesheet">


<link th:href="@{/css/main.css}" rel="stylesheet">

<!--<link href="https://unpkg.com/dropzone@6.0.0-beta.1/dist/dropzone.css" rel="stylesheet" type="text/css" />-->
<!--<link rel="stylesheet" th:href="@{/css/yearpicker.css}"/>-->
<!--<script th:inline="javaScript" th:src="@{js/yearpicker.js}" />-->

<!--<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />-->
<!--<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>-->

<!--<script src="https://cdn.ckeditor.com/ckeditor5/34.0.0/classic/ckeditor.js"></script>-->
<!--<script src="https://cdn.ckeditor.com/ckeditor5/34.0.0/classic/translations/ko.js"></script>-->
<!--<script src="https://unpkg.com/dropzone@6.0.0-beta.1/dist/dropzone-min.js"></script>-->
<link href="https://unpkg.com/dropzone@6.0.0-beta.1/dist/dropzone.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://unpkg.com/dropzone@6.0.0-beta.1/dist/dropzone-min.js"></script>
<link rel="stylesheet" th:href="@{/css/yearpicker.css}"/>
<script th:inline="javaScript" th:src="@{/js/yearpicker.js}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script src="https://cdn.ckeditor.com/ckeditor5/34.0.0/classic/ckeditor.js"></script>
<script src="https://cdn.ckeditor.com/ckeditor5/34.0.0/classic/translations/ko.js"></script>



<script>
    $(function () {





        var now = new Date();
        var year = now.getFullYear();




        document.getElementById("yyyy_f").value = window.opener.document.getElementById("yyyy_f").value;
        document.getElementById("yyyy_t").value = window.opener.document.getElementById("yyyy_t").value;
        document.getElementById("dept_code").value = window.opener.document.getElementById("dept_code").value;
        document.getElementById("area_code").value = window.opener.document.getElementById("area_code").value;
        document.getElementById("act_state2").value = window.opener.document.getElementById("act_state").value;


          var data = $("#contractor_code").val();
          var order = $("#order_code").val();
          var area = $("#region_type").val();

          var bg = $("#expect_bg2").val();
          var gm = $("#expect_gm_code").val();
          var tag = $("#bid_tag2").val();
          var type = $("#bid_type2").val();

          var dept = $("#dept_code2").val();
          var work = $("#work_type2").val();





          $("#contractor_name2").val(data);
          $("#order_name2").val(order);
          $("#region_name2").val(area);
          $("#expect_gm").val(gm);
          $("#expect_bg").val(bg);
          $("#bid_tag").val(tag);
          $("#bid_type").val(type);
          $("#proj_code").val(dept);



        var select_mode = $("#select_mode").val();

        if (select_mode != 'add') {
          document.getElementById("yyyy").value = window.opener.document.getElementById("send_yyyy").value;
          document.getElementById("seq").value = window.opener.document.getElementById("send_seq").value;

        $("#proj_code").select2({ disabled: true });
        $("#cont_name").select2({ disabled: true });
        $("#order_name2").select2({ disabled: true });
        $("#contractor_name2").select2({ disabled: true });
        $("#region_name2").select2({ disabled: true });
        $("#expect_gm").select2({ disabled: true });
        $("#expect_bg").select2({ disabled: true });
        $("#bid_tag").select2({ disabled: true });
        $("#bid_type").select2({ disabled: true });
        $("#work_name").select2({ disabled: true });

        $("#yyyy").attr("disabled",true);
        $("#proj_act_name").attr("disabled",true);
        $("#cont_user").attr("disabled",true);
        $("#phone_no").attr("disabled",true);
        $("#expect_yy").attr("disabled",true);
        $("#cont_dt").attr("disabled",true);

        ClassicEditor.create( document.querySelector( '#remarks' ), {
          language: "ko"

        })
        .then( newEditor => {
          editor = newEditor;
          editor.enableReadOnlyMode("editor");
        })
        .catch( error => {
          console.error( error );
        });

        $("#mod_btn").hide();

        } else {

          document.getElementById("yyyy").value = year;

          $("#proj_code").select2();
          $("#cont_name").select2();
          $("#order_name2").select2();
          $("#contractor_name2").select2();
          $("#region_name2").select2();
          $("#expect_gm").select2();
          $("#expect_bg").select2();
          $("#bid_tag").select2();
          $("#bid_type").select2();
          $("#work_name").select2();

          $("#update_btn").hide();

          $("#sj_state").hide();
          $("#at_state").hide();

          ClassicEditor.create( document.querySelector( '#remarks' ), {
          language: "ko"

          })
          .then( newEditor => {
            editor = newEditor;
          })
          .catch( error => {
            console.error( error );
          });

        }






        var year_chg = $("#expect_yy").val();


        $(".yearpicker").yearpicker({

          startYear:2010,
          endYear: 2050,

        });

        var proj_code = $("#proj_code").val();

        if (proj_code != "") {

          get_work_name();

        }









    })

</script>



<style>
        #priveiwImg{
            width: 80px;
            height: 80px;
        }
        #upload_message{
            font-size:30px;
            font-weight:bolder;
        }
        h6{
            font-size:18px;
            font-weight:bolder;
        }
        body{

        float : left;
        }
        #ajax_indicator {
        position: absolute;
        top: 50%;
        left: 50%;
        height: 200px;
        margin-top: -75px;
        margin-left: -75px;
        z-index: 999999;
        }
        #title {
        margin-left: 10px;
        }
        #modalBtn {
         position: absolute;
         top : 124px;
         left : 37%;
        }
        .select2-selection__rendered {
            line-height: 31px !important;
        }
        .select2-container .select2-selection--single {
            height: 35px !important;
        }
        .select2-selection__arrow {
            height: 34px !important;
        }
        .ck-editor__editable {
          height: 140px;
        }
        .ck-content {
          font-size: 12px;
        }
        .ck-editor__editable p {margin: 0}



    </style>
<body>
<div class="col-12" style="margin: 0px 0px 0px 0px; text-align:center; height:70px; border:1px solid rgba(0, 0, 0, .1); border-width: 0px 0px 1px 0px;">
  <div style="height:15px;"></div>
  <h2 class="mb-3 fw-bold">기본정보</h2>

</div>
<input id="yyyy_f" type="text" hidden/>
<input id="yyyy_t" type="text" hidden/>
<input id="dept_code" type="text" hidden/>
<input id="area_code" type="text" hidden/>
<input id="act_state2" type="text" hidden/>
<input id="select_mode" type="text" th:value="${info.select_mode}" hidden/>
<div id="user_no" class="text-dark mt-1 text-center" th:text="${session.dto.user_no}" hidden></div>
<div id="adm_ck" class="text-dark mt-1 text-center" th:text="${session.dto.adm_ck}" hidden></div>
<input id="seq" type="text" class="form-control" readonly hidden/>


<div id="ajax_indicator" style="display:none;"><img src="/img/loading1.gif"  style="width:50px;" /></div>

<div style="text-align:right; margin:0px 15px 0px 0px;">
  <button id="update_btn" class="btn btn-success modBtn" onclick="update();" th:if="(${session.dto.user_no} == ${info.user_no})">수정</button>
  <button id="mod_btn" style="width:10%;" class="btn btn-success" onclick="save();">저장</button>
</div>
<div class="main_div  container-fluid" id="main_div" style="background-color:#F3F3F3;">
  <div class="row g-0" >
    <div class="col-lg-12" style="margin-top:20px;">



      <div class="row g-3 needs-validation">

        <div class="col-sm-3">
          <label for="yyyy" class="form-label">년도</label>
          <input id="yyyy" type="text" class="form-control yearpicker" />

        </div>
<!--        <div class="col-sm-3">-->
<!--          <label for="dept_name" class="form-label">부서명</label>-->
<!--          <input id="dept_name" th:value="${info?.proj_name}" class="form-control" onchange="get_work_name();" readonly/>-->
<!--          <button id="modalBtn" class="btn btn-success btn-sm" style="width:55px;">변경</button>-->
<!--          <input id="proj_code" th:value="${info?.proj_code}" class="form-control" onchange="get_work_name();" hidden/>-->

<!--        </div>-->
        <div class="col-sm-4">
          <div style="height:2px;"></div>
          <strong><td>부서명</td><span style="color:#ff6b6b"> * </span></strong>
          <input id="dept_name2" th:value="${info?.proj_name}" class="form-control" onchange="get_work_name();" readonly hidden/>
          <input id="dept_code2" th:value="${info?.proj_code}" class="form-control" onchange="get_work_name();" readonly hidden/>
          <div style="height:9px;"></div>
          <select id="proj_code"  class="form-control" onchange="get_work_name();">
            <option value="">선택</option>
            <option th:each="list : ${dept_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>
        <div class="col-sm-2" id="sj_state">
          <label for="suju_state" class="form-label">수주가능성</label>
          <input id="suju_state" readonly type="text" class="form-control" th:value="${info?.suju_state_name}"/>
        </div>
        <div class="col-sm-3" id="at_state">
          <label for="act_state" class="form-label">상태</label>
          <input id="act_state" readonly type="text" class="form-control" th:value="${info?.act_state_name}"/>
        </div>

        <div></div>
        <div class="col-sm-3">
          <label for="region_name" class="form-label">지역구분</label>
          <input id="region_name" type="text" class="form-control" th:value="${info?.region_name}" readonly hidden/>
          <input id="region_type" type="text" class="form-control" th:value="${info?.region_type}" readonly hidden/>

          <select id="region_name2" class="form-control" onchange="edit_region();">
            <option value="">선택</option>
            <option th:each="list : ${area_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>
        <div class="col-sm-2">
          <strong><td class="mb-1 fs-6" >공종명</td></strong>
          <div style="height:10px;"></div>
          <input id="work_name2" type="text" class="form-control" th:value="${info?.work_name}" readonly hidden/>
          <input id="work_type2" type="text" class="form-control" th:value="${info?.work_type}" hidden/>

          <select id="work_name"  class="form-control" onchange="get_work_code();">
            <option value="">선택</option>
            <option th:each="list : ${work_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>


        <div class="col-sm-4">
          <strong><td>공사명</td><span style="color:#ff6b6b"> * </span></strong>
          <div style="height:9px;"></div>
          <input id="proj_act_name" type="text" class="form-control" th:value="${info?.proj_act_name}"/>
        </div>
        <div class="col-sm-3">
          <label for="expect_gm" class="form-label">예상수주규모</label>

          <input id="expect_gm_code" type="text" class="form-control" th:value="${info?.expect_gm}" readonly hidden/>
          <select id="expect_gm" class="form-select" style="width:100%">
            <option value="">선택</option>
            <option th:each="list: ${expect_gm_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>
        <div></div>


        <div class="col-sm-4">
          <strong><td>발주처</td><span style="color:#ff6b6b"> * </span></strong>
          <div style="height:9px;"></div>
          <input id="order_name" class="form-control" th:value="${info?.order_name}" readonly hidden>
          <input id="order_code" class="form-control" th:value="${info?.order_code}" readonly hidden>

          <select id="order_name2" class="form-control" th:value="${info?.order_name}" onchange="edit_ord();">
            <option value="">선택</option>
            <option th:each="list : ${order_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>

          </select>

        </div>
        <div class="col-sm-4">
          <strong><td>원도급사</td><span style="color:#ff6b6b"> * </span></strong>
          <div style="height:9px;"></div>
          <input id="contractor_name" class="form-control" th:value="${info?.contractor_name}" readonly hidden>
          <input id="contractor_code" class="form-control" th:value="${info?.contractor_code}" readonly hidden>


          <select id="contractor_name2" class="form-control" onchange="get_cont_user_name2();">
            <option value="">선택</option>
            <option th:each="list : ${contractor_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>
        <div class="col-sm-2">
          <label for="cont_user" class="form-label">원청담당자</label>
          <input id="cont_user" type="text" class="form-control" th:value="${info?.cont_user_name}"/>
        </div>
        <div class="col-sm-2">
          <label for="phone_no" class="form-label">연락처</label>
          <input id="phone_no" type="text" class="form-control" th:value="${info?.phone}"/>
        </div>
        <div></div>
        <div class="col-sm-2">
          <strong><td>착공시기/년도</td><span style="color:#ff6b6b"> * </span></strong>
          <div style="height:9px;"></div>
          <input type="text" class="form-control yearpicker" id="expect_yy" th:value="${info?.expect_yy}">
        </div>
        <div class="col-sm-2">
          <label for="expect_bg" class="form-label">착공시기/분기</label>
          <input id="expect_bg2" type="text" class="form-control" th:value="${info?.expect_bg}" readonly hidden/>
          <select id="expect_bg" class="form-select" style="width:100%">
            <option th:each="list: ${expect_bg_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>
        <div class="col-sm-2">
          <label for="bid_tag" class="form-label">입찰구분</label>
          <input id="bid_tag2" type="text" class="form-control" th:value="${info?.bid_tag}" readonly hidden/>
          <select id="bid_tag" class="form-select" style="width:100%">
            <option th:each="list: ${bid_tag_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>
        </div>
        <div class="col-sm-3">
          <label for="bid_type" class="form-label">입찰형태</label>
          <input id="bid_type2" type="text" class="form-control" th:value="${info?.bid_type}" readonly hidden/>
          <select id="bid_type" class="form-select" style="width:100%">
            <option th:each="list: ${bid_type_list}" th:text="${list.NAME}" th:value="${list.CODE}"></option>
          </select>

        </div>

        <div class="col-sm-3">
          <strong><td>입찰예정(월)</td><span style="color:#ff6b6b"> * </span></strong>
          <div style="height:9px;"></div>
          <input type="month" class="form-control" id="cont_dt" th:value="${info?.cont_dt}">
        </div>






<!--        <div></div>-->
<!--        <div class="col-sm-3">-->
<!--          <label for="suju_state" class="form-label" hidden>수주가능성</label>-->
<!--          <input id="suju_state" readonly type="text" class="form-control" th:value="${info.suju_state_name}" hidden/>-->
<!--        </div>-->
<!--        <div class="col-sm-3">-->
<!--          <label for="act_state" class="form-label" hidden>상태</label>-->
<!--          <input id="act_state" readonly type="text" class="form-control" th:value="${info.act_state_name}" hidden/>-->
<!--        </div>-->

        <div class="col-sm-12">
          <label for="remarks" class="form-label">특기사항</label>
<!--          <textarea id="remarks" type="text" class="form-control" th:value="${info.remarks}"/>-->
          <textarea id="remarks" type="text" class="form-control" th:text="${info?.remarks}"></textarea>
        </div>


<!--        <div class="col-sm-12">-->
<!--          <label for="remarks">특기사항</label>-->
<!--          <div id="remarks" type="text" />-->
<!--        </div>-->



      </div>


    </div>
  </div>
</div>


<script th:src="@{/js/main.js}"></script>
<script>

</script>







</body>
</html>